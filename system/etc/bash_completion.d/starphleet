# toying with the idea of using this in the future
have sp &&
_starphleet_ship_status() {
  find /tmp -type f -printf "%P "
} &&
_starphleet_ship_list() {
  lxc-ls | grep -e "^starphleet-" | grep -v "starphleet-basic-hull"
} &&
_starphleet_order_list() {
  find "/data/starphleet/headquarters/" -mindepth 2 -maxdepth 2 -type f -iname "orders" -printf "%p\n" | awk -F/ '{print $(NF-1)}'
} &&
_starphleet_ship() {
  # keeping this around as a sample
  if [[ "${COMP_CWORD}" -eq 3 ]]; then
    case "${COMP_WORDS[2]}" in
      status)
        compgen -W "$(_starphleet_ship_status)" -- "${COMP_WORDS[3]}"
      ;;
    esac
  elif [[ "${COMP_CWORD}" -eq 2 ]]; then
    compgen -W "status upgrade start stop" -- "${cur}"
  fi
  return 0
} &&
_starphleet()
{
  COMPREPLY=()
  _get_comp_words_by_ref cur prev

  if [[ "${COMP_CWORD}" -eq 2 ]]; then
    case "${COMP_WORDS[1]}" in
      engage|pilot|decommission|launch)
        COMPREPLY=( $(compgen -W "$(_starphleet_ship_list)" -- "${COMP_WORDS[2]}") )
        return 0
      ;;
      assemble)
        COMPREPLY=( $(compgen -W "$(_starphleet_order_list)" -- "${COMP_WORDS[2]}") )
        return 0
      ;;
      status)
        COMPREPLY=( $(compgen -W "$(_starphleet_ship_status)" -- "${COMP_WORDS[2]}") )
        return 0
      ;;
    esac
  fi
  if [[ "${COMP_CWORD}" -eq 1 ]]; then
    COMPREPLY=( $(compgen -W "assemble decommission engage launch pilot status" -- ${cur}) )
    return 0
  fi
  return 0
} && complete -F _starphleet sp
